<!DOCTYPE html>
<html>
<head>
  <title>Looped SimpleContract Deployer</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.2/dist/ethers.umd.min.js"></script>
</head>
<body style="font-family: Arial; padding: 2rem;">
  <h2>Looped SimpleContract Deployer</h2>

  <button id="connectBtn">ðŸ”Œ Connect OKX Wallet</button>
  <button id="deployBtn" disabled>ðŸš€ Deploy 5 Contracts</button>

  <pre id="log" style="white-space: pre-wrap; margin-top: 1rem;"></pre>

  <script type="module">
    import { CoinWeb3Connect } from 'https://cdn.jsdelivr.net/npm/@okxweb3/coin-web3-connect@1.0.5/+esm';

    let signer;

    const connectBtn = document.getElementById("connectBtn");
    const deployBtn = document.getElementById("deployBtn");
    const log = document.getElementById("log");

    connectBtn.addEventListener("click", async () => {
      log.textContent = "â³ Connecting to OKX Wallet...\n";

      try {
        const provider = await CoinWeb3Connect.connect({
          providerType: 'okxwallet',
          chainId: '0x27da'
        });

        const ethersProvider = new ethers.BrowserProvider(provider);
        signer = await ethersProvider.getSigner();

        log.textContent += "âœ… OKX Wallet connected!\n";
        deployBtn.disabled = false;
      } catch (err) {
        log.textContent += `âŒ Connection failed: ${err.message}\n`;
      }
    });

    deployBtn.addEventListener("click", async () => {
      const bytecode = "608060405234801561001057600080fd5b50600080546001600160a01b03191633179055610104806100326000396000f3fe6080604052600436106100295760003560e01c80632fbebd381461002e5780635524107714610056575b600080fd5b610036610072565b60405161004391906100e0565b60405180910390f35b610070600480360381019061006b91906100a9565b610078565b005b6000546001600160a01b031681565b8060008190555050565b60008054905090565b6001600160a01b03811681146100a557600080fd5b50565b6000602082840312156100ba57600080fd5b81356100c58461009a565b9392505050565b6000602082840312156100e057600080fd5b505191905056fea26469706673582212203a75ae41b7385f16acb25f5f68d1c82d7f8f51f0555f6c9e09c3f7b1e6f53c5464736f6c63430008120033";

      const txCount = 5;
      for (let i = 0; i < txCount; i++) {
        log.textContent += `\nðŸš€ Sending TX ${i + 1}...\n`;

        try {
          const tx = await signer.sendTransaction({
            data: bytecode,
            gasLimit: 200000n
          });

          log.textContent += `TX ${i + 1} Hash: ${tx.hash}\n`;
          await tx.wait();
          log.textContent += `âœ… TX ${i + 1} confirmed.\n`;
        } catch (err) {
          log.textContent += `âŒ TX ${i + 1} failed: ${err.message}\n`;
        }
      }

      log.textContent += "\nðŸŽ‰ All done!";
    });
  </script>
</body>
</html>
